{% extends "base.html" %}
{% block content%}
{% if request.user.is_authenticated %}

<div class="project__details">
  <h2 class="project__title">{{ project.title }}</h2>
  {% if user.id == project.created_by.id or user in project.collaborators.all %}
  <section class="project__header">
    <h3 class="project__header--descriptions">
      <span>Descriptions: </span>
      {{ project.description }}
    </h3>
    <h3 class="project__header--descriptions">
      <span>Collaborators: </span>
      {% if project.project_type == 0 %}
      {{ project.created_by }}
      {% else %}
      {% for collaborator in project.collaborators.all %}
      {{ collaborator.username }}
      <p class="spacing"></p>
      {% endfor %}
      {% endif %}
    </h3>
  </section>
  <section class="project__issues">
    <h3 class="project__issues--title">
      Issues
    </h3>
    <div class="project__issues--main">
      <div class="project__issue--status">
        <div class="project__issues--header">
          <h4 class="issue--title">To Do:</h4>
          <a href="{% url 'create_issue' created_by=project.created_by project_id=project.id %}"
            class="btn btn__issue--add" data-target-modal="#todo_form">
            Add issue
            <span>+</span>
          </a>
        </div>
        <div class="project__issues--container">
          <div class="project__issue">
            {% for issue_to_do in issues_to_do %}
            <div class="issue__container">
              <div class="issue">
                <div class="issue__content">
                  <div class="issue__priority">
                    {{issue_to_do.priority }}
                  </div>
                  <div class="issue__description">
                    {{ issue_to_do.description }}
                  </div>
                </div>
                <div class="issue__type">
                  {{issue_to_do.priority }}
                </div>
              </div>
              <div class="issue__additional">
                <div class="issue__assignee">
                  {{ issue_to_do.assigned_to.username }}
                </div>
                <div class="issue__data">
                  <div class="issue__votes">
                    {{ issue_to_do.votes.count }}
                  </div>
                  <div class="issue__comments">
                    {{ issue_to_do.comments.count }}
                  </div>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      <div class="project__issue--status">
        <div class="project__issues--header">
          <h4 class="project__issue--title">In Progress:</h4>
        </div>
        <div class="project__issues--container">
          <div class="project__issue">
            {% for issue_in_progress in issues_in_progress %}
            <div class="issue__container">
              {{ issue_in_progress }}
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      <div class="project__issue--status">
        <div class="project__issues--header">
          <h4 class="project__issue--title">Done:</h4>
        </div>
        <div class="project__issues--container">
          <div class="project__issue">
            {% for issue_done in issues_done %}
            <div class="issue__container">
              {{ issue_done }}
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </section>
  {% else %}
  <h3 class="project__title--message">You are not authorized to view this project</h3>
  {% endif %}
  {% else %}
  <h3 class="project__title--message">You are not authorized to view this project</h3>
  {% endif %}
</div>
{% endblock %}