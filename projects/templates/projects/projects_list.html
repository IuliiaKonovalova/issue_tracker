{% extends "base.html" %}

{% block content %}
<div class="projects__container">
  <h2 class="projects__title">All projects</h2>
  {% if error %}
  <div class="alert alert-danger">{{ error }}</div>
  {% endif %}
  <div class="projects__group">
    <h3 class="projects__subtitle">My projects:</h3>

    <ul class="projects__list">

      {% for project in projects %}
      {% if project.created_by.id == user.id %}

      {% if project.project_type == 0 %}
      <li class="projects__item">
        <div class="project__icon">
          <i class="fas fa-user"></i>
        </div>

        <div class="projects__item--name">{{ project.title }}</div>
        <!-- <div class="projects__item--members">{{ project.created_by }}</div> -->
        <div class="projects__item--members">Personal</div>
        <div class="projects__item--description">{{ project.description }}</div>

        <a href="#" class="projects__link">Open</a>

      </li>


      {% else %}
      <li class="projects__item">
        <div class="project__icon">
          <i class="fas fa-users"></i>
        </div>
        <div class="projects__item--name">{{ project.title }}</div>

        <div class="projects__item--members">Members:<br>
          {% for collaborator in project.collaborators.all %}
          {{ collaborator.username }},
          {% endfor %}
        </div>
        <div class="projects__item--description">{{ project.description }}</div>

        <a href="#" class="projects__link">Open</a>

      </li>
      {% endif %}
      {% endif %}
      {% endfor %}

      <li class="projects__item">

        <a href="#" class="add__project">
          <i class="fas fa-plus-circle"></i>
        </a>
      </li>
    </ul>
  </div>


  <div class="projects__group">
    <h3 class="projects__subtitle">Other projects:</h3>
    <ul class="projects__list">
      {% for project in projects %}

      {% if project.created_by.id != user.id and user in project.collaborators.all %}
      <li class="projects__item">
        <div class="project__icon">
          <i class="fas fa-users"></i>
        </div>
        <div class="projects__item--name">{{ project.title }}</div>

        <div class="projects__item--members">Members:<br>
          {% for collaborator in project.collaborators.all %}
          {{ collaborator.username }},
          {% endfor %}

        </div>
        <div class="projects__item--description">{{ project.description }}</div>

        <a href="#" class="projects__link">Open</a>

      </li>
      {% endif %}
      {% endfor %}
    </ul>
  </div>
  {% for project in projects %}
  {% if project.created_by.id != user.id and user in project.collaborators.all %}
  <p>{{ project.title }}</p>
  {% endif %}
  {% endfor %}

  <h2>ALL PROJECTS IN DATABASE:</h2>
  {% for project in projects %}
  <p>{{ project.title }}</p>
  {% endfor %}


  <a href="{% url 'create_project' %}">Create a new project</a>
</div>
{% endblock %}