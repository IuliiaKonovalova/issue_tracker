{% extends "base.html" %}

{% block content %}
<div class="projects__container">
  <h2 class="projects__title">All projects</h2>
  {% if error %}
  <div class="alert alert-danger">{{ error }}</div>
  {% endif %}
  <div class="projects__group">
    <h3 class="projects__subtitle">My projects:</h3>

    <ul class="projects__list">

        {% for project in projects %}
            {% if project.created_by.id == user.id %}


                <li class="projects__item">
                    <i class="fas fa-user"></i>
                    <div class="projects__item--name">{{ project.title }}</div>
                    <div class="projects__item--members">{{ project.collaborators.all }}</div>
                    <div class="projects__item--description">{{ project.description }}</div>

                    <a href="{% url 'project_detail' created_by=project.created_by pk=project.id %}" class="projects__link">Open</a>

                </li>
            {% endif %}
        {% endfor %}
        {% for project in projects %}

            {% if project.created_by.id != user.id and user in project.collaborators.all %}
                    <li class="projects__item">
                        <i class="fas fa-users"></i>
                        <div class="projects__item--name">{{ project.title }}</div>
                        <div class="projects__item--members">
                            {% for collaborator in project.collaborators.all %}
                                {{ collaborator.username }}<br>
                            {% endfor %}

                        </div>
                        <div class="projects__item--description">{{ project.description }}</div>

                    <a href="{% url 'project_detail' created_by=project.created_by pk=project.id %}" class="projects__link">Open</a>

                </li>
            {% endif %}
        {% endfor %}
      <li class="projects__item">

        <a href="#" class="add__project">
          <i class="fas fa-plus-circle"></i>
        </a>
      </li>
    </ul>
  </div>
  {% for project in projects %}
  {% if project.created_by.id == user.id %}
  <p>{{ project.title }}</p>
  {% endif %}
  {% endfor %}
  <h3 class="projects__subtitle">Other projects:</h3>
  {% for project in projects %}
  {% if project.created_by.id != user.id and user in project.collaborators.all %}
  <p>{{ project.title }}</p>
  {% endif %}
  {% endfor %}

  <h2>ALL PROJECTS IN DATABASE:</h2>
  {% for project in projects %}
  <p>{{ project.title }}</p>
  {% endfor %}


  <a href="{% url 'create_project' %}">Create a new project</a>
</div>
{% endblock %}